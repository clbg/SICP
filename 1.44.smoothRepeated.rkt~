#lang planet neil/sicp
(define (compose f g)
  (lambda  (x ) ( f ( g x))))

(define  (repeat f n)
  ( if (= 1  n )  f
  (lambda (x ) ((compose  f  (repeat f (- n 1)))  x))))

(define (sqr  x)
  (* x x))

((repeat sqr 2) 5)
  


(define dx 0.00001)

(define (smooth  f n)
  (repeat
   (lambda (x)  (/ (+ (f (- x dx))
                      (f x)
                      (f (+ x dx)))
                   3))
   n))

(define (linean x)
  x)


((smooth linean 5) 5)